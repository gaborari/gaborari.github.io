{"version":3,"sources":["bootstrap/splashLoader.ts"],"names":[],"mappings":"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","file":"../../bootstrap/splashLoader.js","sourcesContent":["// title localizations\r\nlet titles: object[];\r\nlet loadingString: Element;\r\nlet signInString: Element;\r\nlet preloaders: NodeListOf<Element>;\r\n\r\nfunction localizeSplashTitle() {\r\n    // loading span element\r\n    loadingString = document.querySelector('#loading-string');\r\n    signInString = document.querySelector('#signin-string');\r\n\r\n    loadingString.classList.remove('splash-title');\r\n    let indexTitles = [\r\n        { lang: 'en', title: 'Welcome' },\r\n        { lang: 'en-US', title: 'Welcome' },\r\n        { lang: 'fr', title: 'Bienvenue' },\r\n        { lang: 'fr-FR', title: 'Bienvenue à' }\r\n    ];\r\n    let callbackTitles = [\r\n        { lang: 'en', title: 'Authenticated' },\r\n        { lang: 'en-US', title: 'Authenticated' },\r\n        { lang: 'fr', title: 'Authentifié' },\r\n        { lang: 'fr-FR', title: 'Authentifié' }\r\n    ];\r\n    let logoutTitles = [\r\n        { lang: 'en', title: 'You are logged out', signin: 'SIGN IN' },\r\n        { lang: 'en-US', title: 'You are logged out', signin: 'SIGN IN' },\r\n        { lang: 'fr', title: 'Vous êtes déconnecté', signin: 'CONNEXION' },\r\n        { lang: 'fr-FR', title: 'Vous êtes déconnecté', signin: 'CONNEXION' }\r\n    ];\r\n\r\n    switch (document.body.id) {\r\n        case 'index':\r\n            titles = indexTitles;\r\n            break;\r\n        case 'callback':\r\n            titles = callbackTitles;\r\n            break;\r\n        case 'logout':\r\n            titles = logoutTitles;\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n}\r\n\r\n// localization function\r\nfunction localize(language: string) {\r\n    let titleLocalized = titles[0]['title'];\r\n    let signInLocalized = titles[0]['signin'];\r\n\r\n    titles.forEach(function (item: any) {\r\n        if (item['lang'] === language) {\r\n            titleLocalized = item['title'];\r\n            signInLocalized = item['signin'];\r\n        }\r\n    });\r\n    // set title\r\n    loadingString.classList.add('splash-title');\r\n    loadingString.innerHTML = titleLocalized;\r\n    if (document.body.id === 'logout') {\r\n        signInString.innerHTML = signInLocalized;\r\n    }\r\n}\r\n\r\nfunction listenForAppEvents() {\r\n    // loading span element\r\n    loadingString = document.querySelector('#loading-string');\r\n    // preloader elements to be removed after loaded\r\n    preloaders = document.querySelectorAll('.preloader');\r\n    // progress bar\r\n    let determinate = document.querySelector('.mdc-linear-progress');\r\n    // remove animation class\r\n    removeClassHandler();\r\n    // wire events\r\n    document.querySelector('#loading-string').addEventListener('animationend', removeClassHandler);\r\n    window.addEventListener('message', handlePostMessage, false);\r\n    // Handle window.postMessage events\r\n    function handlePostMessage(event: MessageEvent) {\r\n        switch (event.data.eventType) {\r\n            // event to update loading string and reset animation\r\n            case 'loadingEvent':\r\n                console.log('loading event received: ' + event.data.eventLabel);\r\n                let linearProgress = (window as any).mdc.linearProgress.MDCLinearProgress.attachTo(determinate);\r\n                linearProgress.progress = event.data.progress;\r\n                linearProgress.buffer = event.data.progress + 0.2;\r\n                loadingString.classList.add('splash-title');\r\n                loadingString.innerHTML = event.data.eventLabel;\r\n                break;\r\n            // app ready event to remove event listeners and splash elements\r\n            case 'appReadyEvent':\r\n                loadingString.removeEventListener('animationend', removeClassHandler);\r\n                window.removeEventListener('message', handlePostMessage, false);\r\n                removeSplashScreen();\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n}\r\n// remove animation class\r\nfunction removeClassHandler() {\r\n    loadingString.classList.remove('splash-title');\r\n}\r\n\r\n// remove splash screen elements\r\nfunction removeSplashScreen() {\r\n    setTimeout(() => {\r\n        for (let i = 0; i < preloaders.length; i++) {\r\n            let item = preloaders[i];\r\n            item.parentNode.removeChild(item);\r\n        }\r\n    }, 500);\r\n}\r\n\r\nfunction showLoadingError(errorMsg: any) {\r\n    let template = '<span class=\"error-text\">ERROR</span><p>' +\r\n        errorMsg.message.replace(/(?:\\r\\n|\\r|\\n)/g, '<br>') +\r\n    '</p>' +\r\n    '<p class=\"error-text\">Please contact your administrator</p>';\r\n\r\n    let errorPanel = document.querySelector('#errorPanel');\r\n    errorPanel.classList.add('error-panel');\r\n    errorPanel.innerHTML = template;\r\n}\r\n\r\n(function () {\r\n    document.addEventListener('DOMContentLoaded', function(event: Event) {\r\n        listenForAppEvents();\r\n        localizeSplashTitle();\r\n        localize(window.navigator.language);\r\n    });\r\n})();\r\n"]}